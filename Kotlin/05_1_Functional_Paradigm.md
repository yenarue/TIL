###### * 스터디파이 5주차 과제였던 것으로 기억함. 당시 Kotlin은 처음이었지만 함수형을 지향하는 언어들을 몇번 써본적이 있었기에..... 개인적으로 생각하고 있던 함수형 프로그래밍에 대해 아래와 같이 적어서 제출함. 



# 함수형 프로그래밍 패러다임

## vs 명령형 프로그래밍

함수형 프로그래밍이란 선언형 프로그래밍의 일종으로서 **자료 처리를 수학적인 함수의 계산으로 취급하고 상태 및 가변 데이터를 멀리하는** 프로그래밍 패러다임 중 하나이다. 상태/가변 데이터를 멀리하다보니 명령형 프로그래밍과 자주 비교되곤한다. 

### 명령형 프로그래밍

컴퓨터가 수행할 명령들을 순서대로 표현하며 작성하는 명령형 프로그래밍에서는 로직을 작성할때에 하나의 변수가 다양한 논리흐름에서 사용될 수 있다. (예: 전역변수) 그렇다보니 어떤 변수가 언제 어디서 변경될지, 명령형으로 작성된 로직을 순서대로 훑어보지 않는 이상 파악하기가 어렵다. 이를 '참조 투명성이 없다'고 표현한다.

### 함수형 프로그래밍

함수형으로 작성된 로직에서는 특정 파라미터에 대한 함수의 출력값은 언제나 동일하다. `y = f(x)` 를 상상해보라!  함수의 출력값 `y` 는 언제나 그 함수에 입력된 `x` 에만 의존하기 때문이다. 이로 인해 개발자가 예상하기 어려운 side effect가 제거되므로 어떤 방식으로 실행될지 예측하기가 훨씬 수월해진다.

## '패러다임'의 전환

함수형 프로그래밍은 단순히 프로그래밍 언어의 차이라든지 문법적 차이만을 가지는 것이 아니다. 함수형 프로그래밍을 하기 위해서는 **사고하는 법**을 전환해야 한다. 언어의 차이라기보다는 사고의 차이이다. 그렇다보니 사실 명령형 프로그래밍 언어로도 함수형 스타일의 프로그래밍을 할 수 있다. 다만 조금 장황해 보일 뿐이다.

성별이 여자인 사람만 뽑아서 그 들의 나이의 평균을 구하는 코드를 예시로 작성해보도록 하자.

```java
// java - '성별이 여자인 사람만 뽑아서 그들의 나이의 평균을 내는 코드'를 명령형 스타일 프로그래밍으로 작성한 코드
int sum = 0;
int size = 0;
for (Person person: people) {
    if (person.isFemale()) {
        sum = person.getAge();
        size++;
    }
}
float avg = sum / size;
```

위 코드는 전혀 문제가 없어보이는 명령형 스타일의 코드이다. 사실 자세히 뜯어보면 우리에게 익숙한 스타일의 코드일 뿐이지 `sum` 이나 `count` 와 같은 변수들의 상태가 `for` 문 내에서 계속 변경되기 때문에 이러한 로직이 길어질수록 긴장감을 가지고 코드를 읽어나가야 하며 개발자가 머리속으로 상태를 기억하고 있어야 한다는 피로감이 생길 수 있다. 이는 단순한 피로감에서 side effect나 버그로 이어질 수 있는 여지를 만든다.

이제 이 코드를 함수형 스타일로 리팩토링 해보겠다.

```java
// java - '성별이 여자인 사람만 뽑아서 그들의 나이의 평균을 내는 코드'를 함수형 스타일 프로그래밍으로 작성한 코드

// 1. 성별이 여자인 사람들만 추출
List<Person> femalePeople = new ArrayList();
for (Person person : people) {
    if (person.isFemale()) {
        femalePeople.add(person);
    }
}

// 2. 나이를 더한다
int sum = 0;
for (Person person: femalePeople) {
    sum = person.getAge();
}

// 3. 평균을 구한다
float avg = sum / femalePeople.size();
```

위의 코드를 보고나서, '함수를 사용하지 않았는데 왜 함수형 프로그래밍이냐'는 의문이 들 수도 있겠다. 함수형 프로그래밍의 핵심은 '함수를 사용해야 한다'는 것이 아니라 **전체 로직상에서 상태를 제거하고 독립적으로 분리가능한 코드**를 짜는 것이다. (병렬처리 시 독립적인 코드로 분리하는 것을 생각하라!) 위의 코드에서는 주석으로 넘버링 처리 한 구문들이 독립적으로 분리 가능하다. 이를 함수를 제작해 로직을 분리해보면 다음과 같다.

```java
List<Person> femalePeople = filterFemale(people);
int sum = summaryAge(femalePeople);
float avg = avg(sum, femalePeople.size());

public List<Person> filterFemale(List<Person> people) {
    List<Person> femalePeople = new ArrayList();
	for (Person person : people) {
    	if (person.isFemale()) {
        	femalePeople.add(person);
    	}
	}
    return femalePeople
}

public int summaryAge(List<Person> people) {
    int sum = 0;
	for (Person person: people) {
    	sum = person.getAge();
	}
    return sum;
}

public float avg(int sum, int size) {
    return sum / size;
}
```

각 함수들은 자신의 파라미터에만 의존하고 상태는 함수 내부에서만 유지되면 되기 때문에 **메인 코드는 좀 더 심플해지고 명료해졌다**는 것을 알 수 있다.

물론 성능면에서 봤을때는 명령형 프로그래밍 방식이 더 효율적으로 보인다. 하나의 반복문에서 두개의 연산 (filter, sum)을 진행했기 때문이다. 이는 성능을 명료함과 맞바꿨다고 볼 수 있다. 성능은 더 올라갔지만 명료함이 떨어져 휴먼 에러(Human Error, 인간이 발생시키는 실수)나 side effect가 발생한 확률이 높아진다.

기억해야 할 점은, 우리는 명령형 프로그래밍 언어로 함수형 프로그래밍을 체험해봤다는 점이다. 즉, **명령형 프로그래밍과 함수형 프로그래밍의 차이는 '언어'나 '문법'의 차이가 아니라 '패러다임'의 차이**다!

## 함수형 프로그래밍 언어?

OK. 함수형 프로그래밍은 언어의 차이가 아니라 패러다임의 차이라는 것은 잘 알겠다! 그렇다면 함수형 프로그래밍 언어라는 것은 정확히 무엇일까?

### 역사

사실 함수형 언어의 출발은 소프트웨어 공학이 아닌 컴퓨터 과학 학계쪽에서부터 시작되었다. 1930년대, 계산적으로는 떨어지지만 논리적으로는 무결한 시스템인 [람다 대수](<https://ko.wikipedia.org/wiki/%EB%9E%8C%EB%8B%A4_%EB%8C%80%EC%88%98>)가 수학기초론 학계에 출현하였다 (참고: '람다(λ)' 란, 어떤 함수내에 어떤 변수를 종속시키는 것을 뜻한다). 몇몇의 언어학자들이 이 람다대수를 자연어 의미론에 적용함으로써 람다대수는 언어학과 컴퓨터과학측에서 인정받게 되었고, 이 것이 컴퓨터 과학측에서 함수형 프로그래밍의 근간을 세우게 된다.

### 특징

#### 순수 함수 (Pure Function) 

side effect가 없는 함수. 함수의 실행이 외부에 영향을 미치지 않는 함수이다. 함수가 외부 상태에 종속되지 않고 독립적이기 때문에 Thread Saftey 하고 병렬처리가 가능해진다.

#### 익명 함수 (Anonymous Function)

이름이 없는 함수. 명령형 언어에서는 모든 함수에 이름이 붙어야 하지만 함수형 언어에서는 이름을 생략할 수 있다. 이름보다 더 중요한 것은 변수와의 종속관계이기 때문이다.

#### 고계 함수 (higher-order function)

함수를 다루는 함수. 함수형 언어에서는 함수 그 자체도 value 로 취급하므로 함수의 인수(argument)로 전달 가능하고 반환(return)도 가능하다.

#### 불변성 (Immutability)

> 객체지향 프로그래밍은 움직이는 부분을 캡슐화하여 코드 이해를 돕고, 함수형 프로그래밍은 움직이는 부분을 최소화하여 코드 이해를 돕는다. - 마이클 패더스 (『함수형 사고』 中)

변경 가능한 부분을 제거한다. 객체지향 프로그래밍에서는 **변경 가능한 상태(Mutable)를 제어**하는 매커니즘(캡슐화, Scoping, visibility)을 구축하는데에 집중한다. 하지만 함수형 언어에서는 이러한 **변경가능한 부분을 제거**하는데에 집중한다.

**변경 가능한 부분들은 오류가 발생하기 쉽게 만들고**, 이러한 부분들을 **적게** 노출할수록 개발자가 오류를 만들 가능성이 줄어든다는 신념이 기반이 되었다. 여기서 주목해야할 점은 '제거'가 아니라 '적게'라는 점이다. 이 부분에서 함수형 언어이냐, 함수형 스타일 프로그래밍이 가능한 언어냐가 나뉠 수 있다.

### 종류

대표적인 함수형 프로그래밍 언어로는 IPL, LISP, Haskell 이 있다.

#### 더 넓게보면?

순수 함수형 언어외에도 최근에는 대부분의 언어에서 함수형 패러다임의 일부를 차용하고 있는 추세이다. 하드웨어가 점점 발전해나가면서 성능 이슈보다는 휴먼에러나 side effect로 인한 이슈가 더 커져가고 있었던 것도 한 몫 했다. 우리가 아는 대부분의 언어들이 함수형 언어의 특징들을 도입하고 있다. (Java8 이상, Kotlin, Python, Javascript 등…)

## vs 객체지향

Java, Python 등… 이 언어들은 대표적인 객체지향 언어들인데 함수형 언어의 특징을 도입한다는 것이 어떤 의미인지 혼란스러울 수 있을 것 같다. 위에서 편의상 객체지향 프로그래밍과 비교를 하긴했지만 사실 함수형 프로그래밍이 객체지향 프로그래밍과 반대되는 의미는 아니다. 객체지향 패러다임과 함수형 패러다임은 섞일 수 있다. 프로그램을 객체지향적으로 설계하되 로직을 함수형으로 작성하면 되기 때문이다. 사실 상태 관리는 객체지향 측에서도 매우 큰 이슈였고 다양한 방법이 제시되었던 것을 기억해보면 결국 두 패러다임은 같은 목표를 가진다는 것을 알 수 있을 것이다.